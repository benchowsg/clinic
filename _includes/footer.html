<script type="text/javascript">var submitted=false;</script>
<iframe name="hidden_iframe" id="hidden_iframe" style="display:none;" 
        onload="if(submitted) { alert('Thank you! Your message has been sent. We will get back to you shortly.'); window.location.reload(); }">
</iframe>

<div id="whatsapp-container" style="position:fixed; bottom:100px; right:20px; z-index:9999; display:flex; flex-direction:column; align-items:flex-end;">
  <div id="wa-bubble" style="background: white; color: #2c4964; padding: 10px 18px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 12px; font-size: 14px; font-weight: 600; border: 1px solid #eef2f6; position: relative; display: none; white-space: nowrap;">
    Questions? Chat with us!
    <div style="position: absolute; bottom: -8px; right: 20px; width: 0; height: 0; border-left: 8px solid transparent; border-right: 8px solid transparent; border-top: 8px solid white;"></div>
  </div>
  <a id="smart-wa-link" href="https://wa.me/6569621362" target="_blank" rel="noopener noreferrer" style="width:60px; height:60px; background-color:#25d366; color:#FFF; border-radius:50px; text-align:center; font-size:30px; box-shadow: 2px 2px 10px rgba(0,0,0,0.2); display:flex; align-items:center; justify-content:center; text-decoration:none;">
    <i class="fa-brands fa-whatsapp"></i>
  </a>
</div>

<footer id="footer" class="footer mt-5" style="border-top: 1px solid #eee; background: #fff;">
  
  <div class="footer-top py-5">
    <div class="container">
      <div class="row gy-4">
        
        <div class="col-lg-4 footer-info">
          <a href="/" class="logo d-flex align-items-center mb-3 text-decoration-none">
            <h1 style="font-size: 24px; color: #2c4964; font-weight: 700; margin-bottom: 0;">A Healing Heart Medical</h1>
          </a>
          <p class="text-muted">An intermediate care medical clinic. <br>Medisave-approved and CHAS-accredited.</p>
          <h5 class="mt-4 fw-bold" style="color: #2c4964;">Opening Hours</h5>
          <p class="small">
            <strong>Mon to Fri:</strong> 9.30AM – 12.30PM, 2.30PM – 6PM<br>
            <strong>Sat:</strong> 9.30AM – 1PM<br>
            <span class="text-danger fw-bold">Closed on Sundays & Public Holidays</span>
          </p>
        </div>

        <div class="col-lg-3 footer-links">
          <h5 class="fw-bold mb-3" style="color: #2c4964;">Quick Links</h5>
          <ul class="list-unstyled">
            <li class="mb-2"><a href="/who-we-are" style="color: #3498DB; font-weight: 500;">Who We Are</a></li>
            <li class="mb-2"><a href="/booking" style="color: #3498DB; font-weight: 500;">Make an Appointment</a></li>
            <li class="mb-2"><a href="/health-screening" style="color: #3498DB; font-weight: 500;">Health Screening</a></li>
            <li class="mb-2"><a href="/rapid-diagnostics" style="color: #3498DB; font-weight: 500;">Rapid Diagnostics</a></li>
          </ul>
          
          <h5 class="mt-4 fw-bold" style="color: #2c4964;">Clinic Address</h5>
          <p class="small text-muted mb-1">134 Geylang East Avenue 1, #01-227<br>Singapore 380134</p>
          <a href="/location" target="_blank" class="small fw-bold" style="color: #3498DB; text-decoration: underline;">
            <i class="bi bi-geo-alt-fill"></i> Click for Location Map
          </a>
        </div>

        <div class="col-lg-5 footer-message">
          <h5 class="fw-bold mb-3" style="color: #2c4964;">Send Us A Message</h5>
          <form action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSdrwGA9XxxIJFqzb4NLYfYMyYjAEvAefS-KkdIyQIKQHxMOaQ/formResponse" method="POST" target="hidden_iframe" onsubmit="submitted=true;">
            <div class="row g-2 mb-2">
              <div class="col-md-6"><input name="entry.755572643" type="text" class="form-control border shadow-sm" style="padding: 10px;" placeholder="Your Name" required></div>
              <div class="col-md-6"><input name="entry.243023388" type="email" class="form-control border shadow-sm" style="padding: 10px;" placeholder="Your Email" required></div>
            </div>
            <textarea name="entry.866906219" class="form-control border shadow-sm mb-3" style="padding: 10px;" placeholder="How can we help you today?" rows="4" required></textarea>
            <button type="submit" class="btn w-100 fw-bold py-2" style="background: #3498DB; color: white; border: none; border-radius: 8px; box-shadow: 0 4px 6px rgba(52, 152, 219, 0.2);">Send Message</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="fixed-bottom bg-white border-top d-lg-none py-2 px-3 shadow-lg" style="z-index: 9998;">
    <div class="row g-2 text-center">
      <div class="col-4">
        <a href="tel:+6569621362" class="btn w-100 py-2 fw-bold text-white d-flex align-items-center justify-content-center" style="background: #3fbbc0; border: none; font-size: 11px; border-radius: 8px;">
          <i class="fa-solid fa-phone me-1"></i> Call
        </a>
      </div>
      <div class="col-4">
        <a id="smart-wa-mobile" href="https://wa.me/6569621362" class="btn w-100 py-2 fw-bold text-white d-flex align-items-center justify-content-center" style="background: #25d366; border: none; font-size: 11px; border-radius: 8px;">
          <i class="fa-brands fa-whatsapp me-1"></i> WhatsApp
        </a>
      </div>
      <div class="col-4">
        <a href="/booking" class="btn w-100 py-2 fw-bold text-white d-flex align-items-center justify-content-center" style="background: #3498DB; border: none; font-size: 11px; border-radius: 8px;">
          <i class="fa-solid fa-calendar-check me-1"></i> Book
        </a>
      </div>
    </div>
  </div>

  <div class="container border-top pt-4 text-center">
    <div class="d-flex flex-column align-items-center mb-3">
      <div class="mb-1"><span class="text-warning" style="font-size: 1.2rem;">★★★★★</span></div>
      <span class="fw-bold" style="color: #2c4964;">4.8 / 5.0 based on 106 Google Reviews</span>
    </div>
    <div class="copyright pb-4 small text-muted">
      &copy; Copyright <strong><span>A Healing Heart Medical Clinic</span></strong>. All Rights Reserved
    </div>
  </div>
</footer>

<script>
  window.addEventListener('load', function() {
    // 1. WhatsApp Smart Link Logic
    var floatingLink = document.getElementById('smart-wa-link');
    var mobileLink = document.getElementById('smart-wa-mobile');
    var currentPage = window.location.pathname;
    
    // Set the initial default
    var defaultMsg = "Hi A Healing Heart Medical, I'd like to enquire about your services.";

    // Logic to change message based on URL - ALWAYS update defaultMsg
    if (currentPage.includes("post-hospitalisation-recovery")) {
      defaultMsg = "Hi A Healing Heart Medical, I'm enquiring about post-hospital recovery care.";
    } else if (currentPage.includes("location")) {
      defaultMsg = "Hi A Healing Heart Medical, I am looking for your clinic location.";
    } else if (currentPage.includes("health-screening")) {
      defaultMsg = "Hi A Healing Heart, I'd like to book a health screening.";
    } else if (currentPage.includes("heart-health-screening")) {
      defaultMsg = "Hi A Healing Heart, I'd like to book a cardiac heart screening.";
    } else if (currentPage.includes("vaccination")) {
      defaultMsg = "Hi A Healing Heart, I'd like to book a vaccination appointment.";
    } else if (currentPage.includes("cardiology")) {
      defaultMsg = "Hi A Healing Heart, I'd like to book an appointment regarding my heart condition.";
    } else if (currentPage.includes("rapid-diagnostics")) {
      defaultMsg = "Hi A Healing Heart, I'd like to book an appointment for rapid diagnostics.";
    } else if (currentPage.includes("regenerative-medicine")) {
      defaultMsg = "Hi A Healing Heart, I'd like to book an appointment for regenerative medicine.";
    } else if (currentPage.includes("skin-hair-care")) {
      defaultMsg = "Hi A Healing Heart, I'd like to book an appointment for skin/hair care.";
    } else if (currentPage.includes("hormone-optimization")) {
      defaultMsg = "Hi A Healing Heart, I'd like to book an appointment for hormonal issues.";
    }

    // Now finalUrl uses the updated defaultMsg correctly
    var finalUrl = "https://wa.me/6569621362?text=" + encodeURIComponent(defaultMsg);
    
    if(floatingLink) floatingLink.href = finalUrl;
    if(mobileLink) mobileLink.href = finalUrl;

    // 2. Attention Bubble Logic
    const bubble = document.getElementById('wa-bubble');
    if (bubble) {
      setTimeout(() => { 
        bubble.style.display = 'block'; 
      }, 3000); 
      
      setTimeout(() => {
        bubble.style.opacity = '0';
        bubble.style.transition = 'opacity 1s ease';
        setTimeout(() => { bubble.style.display = 'none'; }, 1000);
      }, 12000);
    }
  });
</script>
